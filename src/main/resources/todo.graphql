type User
@size(maxEntities: 10000)
{
  user_id: ID
  username: String @selectivity(exp: 0)
  todos: [Todo] @inverse(field: "user") @multiplicity(maxSize: 1000)
}

type Todo
@size(maxEntities: 100000)
@selectivity(exp_5: [["user.username", "title"]])
{
  todo_id: ID
  title: String
    @mutable
    @selectivity(exp: 4, distribution: "zipf")
    @size(bytes: 1000)
  status: boolean @mutable
  user: User! @inverse(field: "todos")
}

type Query
@cluster(size_gb: "500")
 {
  todosByUser: [Todo] @sql(where: user.username = $username)
  todosByTitle: [Todo] @sql(where: user.username = $username AND title = $title)
  user: [User] @sql(where: user_id = $user_id)
}

query GetTodosByUser($username: String)
@sla(throughput:10000, latency_ms: 100)
 {
  todosByUser(user_id: $user_id) {
    title
    status
    user {
      user_id
    }
  }
  todosByTitle(user_id: $username) {
    title
    status
    user {
      user_id
    }
  }

  user(user_id: $username) {
    title
    status
    user {
      user_id
    }
  }
}